
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>✈️ Flight Operations Management System</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f6fa;
            color: #333;
        }
        
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 260px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 40px;
            padding: 0 20px;
        }
        
        .logo i {
            margin-right: 10px;
            font-size: 28px;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover, .nav-item.active {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: #fff;
        }
        
        .nav-item i {
            margin-right: 12px;
            width: 20px;
        }
        
        .main-content {
            margin-left: 260px;
            flex: 1;
            padding: 0;
        }
        
        .header {
            background: white;
            padding: 20px 30px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #333;
            font-weight: 300;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .btn-refresh {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn-refresh:hover {
            background: #5a67d8;
        }
        
        .time-display {
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 6px;
            font-family: monospace;
            color: #666;
        }
        
        .content-section {
            display: none;
            padding: 30px;
            min-height: calc(100vh - 80px);
        }
        
        .content-section.active {
            display: block;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .charts-container {
            display: grid;
            gap: 25px;
        }
        
        .chart {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .chart h3 {
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Analytics Section */
        .analytics-controls {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .filter-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-top: 15px;
        }
        
        .filter-controls select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
        }
        
        .btn-generate {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
        }
        
        /* Scheduling Section */
        .scheduling-container {
            display: grid;
            gap: 25px;
        }
        
        .scheduling-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn-optimize {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .scheduling-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }
        
        .schedule-calendar, .schedule-optimization {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        /* Predictions Section */
        .predictions-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }
        
        .prediction-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .prediction-controls input, .prediction-controls select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        
        .predictions-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }
        
        .prediction-charts, .prediction-insights {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        /* NLP Query Section */
        .nlp-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .nlp-header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .query-interface {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .query-input-container {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .nlp-query-input {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .nlp-query-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .query-btn-nlp {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .sample-queries {
            margin-bottom: 25px;
        }
        
        .query-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .sample-query-btn {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .sample-query-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .nlp-query-result {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            min-height: 100px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            
            .main-content {
                margin-left: 200px;
            }
            
            .scheduling-content, .predictions-content {
                grid-template-columns: 1fr;
            }
        }
        
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-plane"></i>
                <span>Flight Ops</span>
            </div>
            <nav class="nav-menu">
                <a href="#dashboard" class="nav-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
                <a href="#analytics" class="nav-item" onclick="showSection('analytics')">
                    <i class="fas fa-chart-line"></i> Analytics
                </a>
                <a href="#scheduling" class="nav-item" onclick="showSection('scheduling')">
                    <i class="fas fa-calendar-alt"></i> Scheduling
                </a>
                <a href="#predictions" class="nav-item" onclick="showSection('predictions')">
                    <i class="fas fa-crystal-ball"></i> Predictions
                </a>
                <a href="#nlp-query" class="nav-item" onclick="showSection('nlp-query')">
                    <i class="fas fa-comments"></i> NLP Query
                </a>
            </nav>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1 id="page-title">✈️ Flight Operations Dashboard</h1>
                <div class="header-actions">
                    <button class="btn-refresh" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <div class="time-display" id="currentTime"></div>
                </div>
            </div>
            
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="content-section active">
                <!-- Statistics Cards -->
                <div class="stats-grid">
                    
        <div class="stat-card">
            <div class="stat-number">441</div>
            <div class="stat-label">Total Flights</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">43.3%</div>
            <div class="stat-label">On-Time Performance</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">63</div>
            <div class="stat-label">Daily Average</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">9</div>
            <div class="stat-label">Airlines</div>
        </div>
        
                <div class="stat-card">
                    <div class="stat-number">22.2min</div>
                    <div class="stat-label">Avg Delay</div>
                </div>
                
                </div>
                
                <!-- Main Charts -->
                <div class="charts-container">
                    
        <div class="chart">
            <h3><i class="fas fa-tachometer-alt"></i> Operations Overview</h3>
            <div id="operationsChart"><div>                            <div id="8b100250-3a16-42b5-bb0f-632e85165def" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("8b100250-3a16-42b5-bb0f-632e85165def")) {                    Plotly.newPlot(                        "8b100250-3a16-42b5-bb0f-632e85165def",                        [{"marker":{"color":"lightblue"},"name":"Flight Count","opacity":0.7,"x":{"dtype":"f8","bdata":"AAAAAAAAFEAAAAAAAAAYQAAAAAAAABxAAAAAAAAAIEAAAAAAAAAkQA=="},"xaxis":"x","y":{"dtype":"i2","bdata":"AQCjAH0AWwAFAA=="},"yaxis":"y","type":"bar"},{"line":{"color":"red","width":3},"mode":"lines+markers","name":"Avg Delay","x":{"dtype":"f8","bdata":"AAAAAAAAFEAAAAAAAAAYQAAAAAAAABxAAAAAAAAAIEAAAAAAAAAkQA=="},"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAAAANEDUM5Xrjhc0QKabxCCwcjBAf+mXfumXPUCamZmZmdlZQA=="},"yaxis":"y2","type":"scatter"}],                        {"height":400,"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Hourly Operations"},"xaxis":{"anchor":"y","domain":[0.0,0.94]},"yaxis":{"anchor":"x","domain":[0.0,1.0]},"yaxis2":{"anchor":"x","overlaying":"y","side":"right"}},                        {"responsive": true}                    )                };            </script>        </div></div>
        </div>
        

        <div class="chart">
            <h3><i class="fas fa-chart-line"></i> Performance Trends</h3>
            <div id="performanceChart"><div>                            <div id="491b8f44-ef6e-4f9f-bba4-746502241791" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("491b8f44-ef6e-4f9f-bba4-746502241791")) {                    Plotly.newPlot(                        "491b8f44-ef6e-4f9f-bba4-746502241791",                        [{"line":{"color":"green","width":2},"mode":"lines+markers","name":"On-Time %","x":["2025-07-19","2025-07-20","2025-07-21","2025-07-22","2025-07-23","2025-07-24","2025-07-25"],"y":{"dtype":"f8","bdata":"JEmSJEmSTEC2bdu2bVtOQCRJkiRJkjxAEtpLaC+hTUBfQnsJ7SVHQC666KKLLkxAHcdxHMdxQ0A="},"type":"scatter"}],                        {"height":400,"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Daily Performance Trends"},"yaxis":{"title":{"text":"On-Time Performance (%)"}}},                        {"responsive": true}                    )                };            </script>        </div></div>
        </div>
        
                </div>
            </div>
            
            <!-- Analytics Section -->
            <div id="analytics-section" class="content-section">
                <div class="analytics-container">
                    <div class="analytics-controls">
                        <h3><i class="fas fa-filter"></i> Advanced Analytics</h3>
                        <div class="filter-controls">
                            <select id="analytics-metric" onchange="updateAnalytics()">
                                <option value="delays">Delay Analysis</option>
                                <option value="performance">Performance Metrics</option>
                                <option value="efficiency">Efficiency Analysis</option>
                                <option value="trends">Trend Analysis</option>
                            </select>
                            <select id="analytics-timeframe" onchange="updateAnalytics()">
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>
                            <button onclick="generateReport()" class="btn-generate">
                                <i class="fas fa-file-pdf"></i> Generate Report
                            </button>
                        </div>
                    </div>
                    <div id="analytics-charts" class="analytics-charts">
                        <div id="dynamic-analytics">Select a metric to view advanced analytics</div>
                    </div>
                </div>
            </div>
            
            <!-- Scheduling Section -->
            <div id="scheduling-section" class="content-section">
                <div class="scheduling-container">
                    <div class="scheduling-header">
                        <h3><i class="fas fa-calendar-alt"></i> Flight Scheduling Management</h3>
                        <button onclick="optimizeSchedule()" class="btn-optimize">
                            <i class="fas fa-magic"></i> Optimize Schedule
                        </button>
                    </div>
                    <div class="scheduling-content">
                        <div class="schedule-calendar">
                            <div id="calendar-view">
        <div class="calendar-container">
            <h4>Flight Schedule Calendar</h4>
            <div class="calendar-grid" id="schedule-calendar">
                <!-- Calendar will be populated by JavaScript -->
            </div>
        </div>
        </div>
                        </div>
                        <div class="schedule-optimization">
                            <h4>Schedule Optimization Insights</h4>
                            <div id="optimization-results">
                                <ul><li>Peak delay hour: 10.0:00</li><li>Best performance day: Sunday</li></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Predictions Section -->
            <div id="predictions-section" class="content-section">
                <div class="predictions-container">
                    <div class="predictions-header">
                        <h3><i class="fas fa-crystal-ball"></i> Predictive Analytics</h3>
                        <div class="prediction-controls">
                            <input type="date" id="prediction-date" onchange="updatePredictions()">
                            <select id="prediction-type" onchange="updatePredictions()">
                                <option value="delays">Delay Prediction</option>
                                <option value="demand">Demand Forecast</option>
                                <option value="performance">Performance Forecast</option>
                            </select>
                        </div>
                    </div>
                    <div class="predictions-content">
                        <div class="prediction-charts">
                            <div id="prediction-results"><div id="prediction-chart-container">Prediction models will be displayed here</div></div>
                        </div>
                        <div class="prediction-insights">
                            <h4>AI-Powered Insights</h4>
                            <div id="ai-insights">
                                <ul><li>⚠️ High average delays detected - consider schedule optimization</li></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- NLP Query Section -->
            <div id="nlp-query-section" class="content-section">
                <div class="nlp-container">
                    <div class="nlp-header">
                        <h3><i class="fas fa-comments"></i> Natural Language Query Interface</h3>
                        <p>Ask questions about your flight data in plain English</p>
                    </div>
                    
                    <div class="query-interface">
                        <div class="query-input-container">
                            <input type="text" id="nlp-query-input" class="nlp-query-input" 
                                   placeholder="Ask me anything about your flight data... e.g., 'What's the average delay for morning flights?'">
                            <button onclick="processNLPQuery()" class="query-btn-nlp">
                                <i class="fas fa-paper-plane"></i> Ask
                            </button>
                        </div>
                        
                        <div class="sample-queries">
                            <h4>Sample Questions:</h4>
                            <div class="query-buttons">
                                <button class="sample-query-btn" onclick="setNLPQuery('What is the average delay by airline?')">
                                    Average delay by airline
                                </button>
                                <button class="sample-query-btn" onclick="setNLPQuery('Which hours have the most delays?')">
                                    Peak delay hours
                                </button>
                                <button class="sample-query-btn" onclick="setNLPQuery('Show me weekend vs weekday performance')">
                                    Weekend vs weekday
                                </button>
                                <button class="sample-query-btn" onclick="setNLPQuery('Which routes are most delayed?')">
                                    Most delayed routes
                                </button>
                                <button class="sample-query-btn" onclick="setNLPQuery('Predict delays for next week')">
                                    Predict next week delays
                                </button>
                                <button class="sample-query-btn" onclick="setNLPQuery('What are the seasonal trends?')">
                                    Seasonal trends
                                </button>
                            </div>
                        </div>
                        
                        <div id="nlp-query-result" class="nlp-query-result"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Flight data for all features
        const flightData = {"total_flights": 441, "columns": ["S.No", "Flight Number", "date_col_2", "From", "To", "Aircraft", "Flight time", "STD", "ATD", "STA", "ATA", "unnamed2", "unnamed3", "Date", "ATA_time", "STD_dt", "ATD_dt", "STA_dt", "ATA_time_dt", "Departure Delay (min)", "Arrival Delay (min)", "Departure Hour", "Arrival Hour", "Airline", "Day of Week", "Is Weekend", "On Time"], "date_range": {"start": "2025-07-19T00:00:00", "end": "2025-07-25T00:00:00"}, "delay_stats": {"mean": 22.236363636363638, "median": 16.0, "std": 28.152093011161547, "min": -16.0, "max": 203.0}, "airline_stats": {"AI": {"flights": 14, "on_time_rate": 0.0, "avg_delay": NaN}, "GF": {"flights": 1, "on_time_rate": 0.0, "avg_delay": NaN}, "IX": {"flights": 1, "on_time_rate": 0.0, "avg_delay": NaN}, "OV": {"flights": 1, "on_time_rate": 0.0, "avg_delay": NaN}, "QO": {"flights": 1, "on_time_rate": 0.0, "avg_delay": NaN}, "QP": {"flights": 4, "on_time_rate": 0.0, "avg_delay": NaN}, "SG": {"flights": 1, "on_time_rate": 0.0, "avg_delay": NaN}, "TK": {"flights": 1, "on_time_rate": 0.0, "avg_delay": NaN}, "WY": {"flights": 1, "on_time_rate": 0.0, "avg_delay": NaN}}, "on_time_rate": 0.4331065759637188, "hourly_stats": {"5": {"flights": 1, "avg_delay": 20.0}, "6": {"flights": 163, "avg_delay": 20.0920245398773}, "7": {"flights": 125, "avg_delay": 16.448}, "8": {"flights": 91, "avg_delay": 29.593406593406595}, "10": {"flights": 5, "avg_delay": 103.4}}};
        const analysisResults = {"basic_stats": {"total_flights": 441, "unique_airlines": 9, "date_range": {"start": "2025-07-19T00:00:00", "end": "2025-07-25T00:00:00"}, "avg_daily_flights": 63.0}, "peak_analysis": {"hourly_stats": {"Flight Count": {"5.0": 1, "6.0": 163, "7.0": 125, "8.0": 91, "10.0": 5}, "Avg Delay": {"5.0": 20.0, "6.0": 20.09, "7.0": 16.45, "8.0": 29.59, "10.0": 103.4}, "Delay Std": {"5.0": NaN, "6.0": 28.41, "7.0": 15.35, "8.0": 28.92, "10.0": 81.06}, "Congestion Index": {"5.0": 20.0, "6.0": 3274.67, "7.0": 2056.25, "8.0": 2692.69, "10.0": 517.0}}, "peak_hours": {"Flight Count": {"6.0": 163, "7.0": 125, "8.0": 91, "10.0": 5, "5.0": 1}, "Avg Delay": {"6.0": 20.09, "7.0": 16.45, "8.0": 29.59, "10.0": 103.4, "5.0": 20.0}, "Delay Std": {"6.0": 28.41, "7.0": 15.35, "8.0": 28.92, "10.0": 81.06, "5.0": NaN}, "Congestion Index": {"6.0": 3274.67, "7.0": 2056.25, "8.0": 2692.69, "10.0": 517.0, "5.0": 20.0}}, "busiest_hour": 6.0, "most_congested_hour": 6.0}, "delay_analysis": {"Departure Delay (min)": {"mean": 22.236363636363638, "median": 16.0, "std": 28.152093011161547, "percentiles": {"25th": 9.0, "75th": 24.0, "95th": 67.79999999999995}, "on_time_rate": 0.4961038961038961}, "Arrival Delay (min)": {"mean": -3.8671875, "median": -10.0, "std": 29.707021374788503, "percentiles": {"25th": -19.25, "75th": 2.0, "95th": 43.5499999999999}, "on_time_rate": 0.8802083333333334}, "daily_patterns": {"Friday": 23.90740740740741, "Monday": 41.339285714285715, "Saturday": 18.0, "Sunday": 18.125, "Thursday": 15.872727272727273, "Tuesday": 18.0, "Wednesday": 20.12962962962963}}, "efficiency_metrics": {"on_time_performance": 0.4331065759637188, "severe_delay_rate": 0.14058956916099774, "airline_performance": {"AI": 0.0, "GF": 0.0, "IX": 0.0, "OV": 0.0, "QO": 0.0, "QP": 0.0, "SG": 0.0, "TK": 0.0, "WY": 0.0}}, "simulation": {"delay_reduction_scenario": {"reduction_minutes": 5, "current_avg_delay": 22.236363636363638, "simulated_avg_delay": 17.25194805194805, "improvement": 4.984415584415586, "percent_improvement": 22.415605653545153}}, "cascade_analysis": {"affected_flights": 0, "avg_cascade_impact": 0, "total_cascade_minutes": 0}};
        const predictionData = {"hourly_delays": {"5.0": 20.0, "6.0": 20.0920245398773, "7.0": 16.448, "8.0": 29.593406593406595, "10.0": 103.4}};
        
        
        // Current section tracking
        let currentSection = 'dashboard';

        // Enhanced NLP Query Processing
    function processNLPQuery() {
        const query = document.getElementById('nlp-query-input').value.toLowerCase().trim();
        const resultDiv = document.getElementById('nlp-query-result');
        
        if (!query) {
            resultDiv.innerHTML = '<p>Please enter a question about the flight data.</p>';
            return;
        }
        
        // Show loading state
        resultDiv.innerHTML = '<div class="loading">🤔 Processing your query...</div>';
        
        // Simulate processing delay for better UX
        setTimeout(() => {
            const response = processNLPQueryLogic(query);
            resultDiv.innerHTML = response;
        }, 500);
    }
    
    function processNLPQueryLogic(query) {
        // Enhanced pattern matching
        if (query.includes('average delay') || query.includes('mean delay')) {
            if (query.includes('airline') && flightData.airline_stats) {
                return generateAirlineDelayAnalysis();
            } else if (flightData.delay_stats) {
                return `The average departure delay is <strong>${flightData.delay_stats.mean.toFixed(1)} minutes</strong>. The median delay is ${flightData.delay_stats.median.toFixed(1)} minutes, indicating ${flightData.delay_stats.mean > flightData.delay_stats.median ? 'some flights with very long delays' : 'fairly consistent delay patterns'}.`;
            }
        }
        else if (query.includes('best airline') || query.includes('worst airline')) {
            if (flightData.airline_stats) {
                return generateAirlineRanking(query.includes('best'));
            } else {
                return 'Airline performance data is not available.';
            }
        }
        else if (query.includes('peak hour') || query.includes('busiest hour') || query.includes('busy time')) {
            if (flightData.hourly_stats) {
                return generatePeakHourAnalysis();
            } else {
                return 'Hourly flight data is not available.';
            }
        }
        else if (query.includes('predict') || query.includes('forecast')) {
            return generatePredictiveInsights();
        }
        else if (query.includes('weekend') && query.includes('weekday')) {
            return generateWeekendVsWeekdayAnalysis();
        }
        else if (query.includes('seasonal') || query.includes('trend')) {
            return generateSeasonalTrends();
        }
        else if (query.includes('route') && query.includes('delay')) {
            return 'Route-specific delay analysis would require origin-destination data. Consider analyzing by airline or time of day instead.';
        }
        else if (query.includes('on-time') || query.includes('punctual')) {
            if (flightData.on_time_rate) {
                return generateOnTimeAnalysis();
            } else {
                return 'On-time performance data is not available.';
            }
        }
        else if (query.includes('summary') || query.includes('overview')) {
            return generateComprehensiveSummary();
        }
        else {
            return generateHelpResponse();
        }
    }
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            updateTime();
            setInterval(updateTime, 1000);
            initializeCalendar();
            updatePredictions();
        });
        
        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = now.toLocaleTimeString();
        }
        
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName + '-section').classList.add('active');
            
            // Add active class to selected nav item
            event.target.classList.add('active');
            
            // Update page title
            const titles = {
                'dashboard': '✈️ Flight Operations Dashboard',
                'analytics': '📊 Advanced Analytics',
                'scheduling': '📅 Flight Scheduling',
                'predictions': '🔮 Predictive Analytics',
                'nlp-query': '💬 Natural Language Query'
            };
            
            document.getElementById('page-title').textContent = titles[sectionName];
            currentSection = sectionName;
            
            // Load section-specific content
            if (sectionName === 'analytics') {
                updateAnalytics();
            } else if (sectionName === 'predictions') {
                updatePredictions();
            }
        }
        
        function refreshData() {
            const btn = document.querySelector('.btn-refresh i');
            btn.classList.add('fa-spin');
            
            // Simulate data refresh
            setTimeout(() => {
                btn.classList.remove('fa-spin');
                alert('Data refreshed successfully!');
            }, 2000);
        }
        
        // Analytics Functions
        function updateAnalytics() {
            const metric = document.getElementById('analytics-metric').value;
            const timeframe = document.getElementById('analytics-timeframe').value;
            
            const analyticsContainer = document.getElementById('analytics-charts');
            
            let content = '';
            
            switch(metric) {
                case 'delays':
                    content = generateDelayAnalytics(timeframe);
                    break;
                case 'performance':
                    content = generatePerformanceAnalytics(timeframe);
                    break;
                case 'efficiency':
                    content = generateEfficiencyAnalytics(timeframe);
                    break;
                case 'trends':
                    content = generateTrendAnalytics(timeframe);
                    break;
            }
            
            analyticsContainer.innerHTML = content;
        }
        
        function generateDelayAnalytics(timeframe) {
            if (!flightData.delay_stats) {
                return '<div class="analytics-chart"><h4>Delay Analytics</h4><p>No delay data available</p></div>';
            }
            
            const stats = flightData.delay_stats;
            return `
                <div class="analytics-chart">
                    <h4>Delay Analysis (${timeframe})</h4>
                    <div class="analytics-metrics">
                        <div class="metric-card">
                            <div class="metric-value">${stats.mean.toFixed(1)} min</div>
                            <div class="metric-label">Average Delay</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${stats.median.toFixed(1)} min</div>
                            <div class="metric-label">Median Delay</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${stats.max.toFixed(1)} min</div>
                            <div class="metric-label">Maximum Delay</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${stats.std.toFixed(1)} min</div>
                            <div class="metric-label">Standard Deviation</div>
                        </div>
                    </div>
                    <div class="insights">
                        <h5>Key Insights:</h5>
                        <ul>
                            <li>${stats.mean > 15 ? 'High average delays require attention' : 'Delays are within acceptable limits'}</li>
                            <li>${stats.std > 20 ? 'High variability in delays' : 'Consistent delay patterns'}</li>
                        </ul>
                    </div>
                </div>
            `;
        }
        
        function generatePerformanceAnalytics(timeframe) {
            const onTimeRate = flightData.on_time_rate || 0;
            return `
                <div class="analytics-chart">
                    <h4>Performance Analytics (${timeframe})</h4>
                    <div class="analytics-metrics">
                        <div class="metric-card">
                            <div class="metric-value">${(onTimeRate * 100).toFixed(1)}%</div>
                            <div class="metric-label">On-Time Performance</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${((1 - onTimeRate) * 100).toFixed(1)}%</div>
                            <div class="metric-label">Delayed Flights</div>
                        </div>
                    </div>
                    <div class="performance-gauge">
                        <div class="gauge-container">
                            <div class="gauge-bar">
                                <div class="gauge-fill" style="width: ${onTimeRate * 100}%"></div>
                            </div>
                            <div class="gauge-label">Overall Performance Score</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function generateEfficiencyAnalytics(timeframe) {
            const totalFlights = flightData.total_flights;
            const avgDailyFlights = totalFlights / 30; // Assuming 30 days of data
            
            return `
                <div class="analytics-chart">
                    <h4>Efficiency Analysis (${timeframe})</h4>
                    <div class="analytics-metrics">
                        <div class="metric-card">
                            <div class="metric-value">${totalFlights.toLocaleString()}</div>
                            <div class="metric-label">Total Flights</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${avgDailyFlights.toFixed(0)}</div>
                            <div class="metric-label">Daily Average</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${Object.keys(flightData.airline_stats || {}).length}</div>
                            <div class="metric-label">Active Airlines</div>
                        </div>
                    </div>
                    <div class="efficiency-recommendations">
                        <h5>Efficiency Recommendations:</h5>
                        <ul>
                            <li>Optimize peak hour scheduling</li>
                            <li>Implement predictive maintenance</li>
                            <li>Enhance ground operations coordination</li>
                        </ul>
                    </div>
                </div>
            `;
        }
        
        function generateTrendAnalytics(timeframe) {
            return `
                <div class="analytics-chart">
                    <h4>Trend Analysis (${timeframe})</h4>
                    <div class="trend-indicators">
                        <div class="trend-item">
                            <span class="trend-icon">📈</span>
                            <span class="trend-text">Flight volume trending upward</span>
                        </div>
                        <div class="trend-item">
                            <span class="trend-icon">📊</span>
                            <span class="trend-text">Performance metrics stable</span>
                        </div>
                        <div class="trend-item">
                            <span class="trend-icon">⏰</span>
                            <span class="trend-text">Peak hours: 8AM-10AM, 6PM-8PM</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function generateReport() {
            alert('Analytics report generated! (This would typically download a PDF report)');
        }
        
        // Scheduling Functions
        function initializeCalendar() {
            const calendarContainer = document.getElementById('schedule-calendar');
            if (!calendarContainer) return;
            
            const today = new Date();
            const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
            
            let calendarHTML = '<div class="calendar-header">';
            calendarHTML += '<h5>Flight Schedule - ' + today.toLocaleDateString('en-US', {month: 'long', year: 'numeric'}) + '</h5>';
            calendarHTML += '</div><div class="calendar-days">';
            
            const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            dayNames.forEach(day => {
                calendarHTML += `<div class="calendar-day-header">${day}</div>`;
            });
            
            const firstDay = new Date(today.getFullYear(), today.getMonth(), 1).getDay();
            
            // Empty cells for days before the first day of the month
            for (let i = 0; i < firstDay; i++) {
                calendarHTML += '<div class="calendar-day empty"></div>';
            }
            
            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = day === today.getDate();
                const flightCount = Math.floor(Math.random() * 50) + 10; // Simulated flight count
                
                calendarHTML += `
                    <div class="calendar-day ${isToday ? 'today' : ''}" onclick="showDayDetails(${day})">
                        <div class="day-number">${day}</div>
                        <div class="flight-count">${flightCount} flights</div>
                    </div>
                `;
            }
            
            calendarHTML += '</div>';
            calendarContainer.innerHTML = calendarHTML;
        }
        
        function showDayDetails(day) {
            alert(`Flight details for day ${day} would be shown here`);
        }
        
        function optimizeSchedule() {
            alert('Running schedule optimization algorithm... (This would perform actual optimization)');
        }
        
        // Prediction Functions
        function updatePredictions() {
            const predictionType = document.getElementById('prediction-type')?.value || 'delays';
            const predictionDate = document.getElementById('prediction-date')?.value || new Date().toISOString().split('T')[0];
            
            const container = document.getElementById('prediction-results');
            if (!container) return;
            
            let content = '';
            
            switch(predictionType) {
                case 'delays':
                    content = generateDelayPredictions(predictionDate);
                    break;
                case 'demand':
                    content = generateDemandForecast(predictionDate);
                    break;
                case 'performance':
                    content = generatePerformanceForecast(predictionDate);
                    break;
            }
            
            container.innerHTML = content;
        }
        
        function generateDelayPredictions(date) {
            return `
                <div class="prediction-chart">
                    <h4>Delay Predictions for ${date}</h4>
                    <div class="prediction-grid">
                        <div class="prediction-item">
                            <div class="prediction-time">06:00-08:00</div>
                            <div class="prediction-value low">Low Risk</div>
                            <div class="prediction-detail">Avg delay: 5 min</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-time">08:00-10:00</div>
                            <div class="prediction-value high">High Risk</div>
                            <div class="prediction-detail">Avg delay: 25 min</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-time">10:00-12:00</div>
                            <div class="prediction-value medium">Medium Risk</div>
                            <div class="prediction-detail">Avg delay: 15 min</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-time">18:00-20:00</div>
                            <div class="prediction-value high">High Risk</div>
                            <div class="prediction-detail">Avg delay: 30 min</div>
                        </div>
                    </div>
                    <div class="prediction-recommendations">
                        <h5>Recommendations:</h5>
                        <ul>
                            <li>Increase ground crew during peak hours (8-10 AM, 6-8 PM)</li>
                            <li>Consider rescheduling non-critical flights</li>
                            <li>Implement proactive passenger communication</li>
                        </ul>
                    </div>
                </div>
            `;
        }
        
        function generateDemandForecast(date) {
            return `
                <div class="prediction-chart">
                    <h4>Demand Forecast for ${date}</h4>
                    <div class="demand-metrics">
                        <div class="demand-card">
                            <div class="demand-value">145</div>
                            <div class="demand-label">Predicted Flights</div>
                            <div class="demand-change">↑ 12% vs last week</div>
                        </div>
                        <div class="demand-card">
                            <div class="demand-value">87%</div>
                            <div class="demand-label">Capacity Utilization</div>
                            <div class="demand-change">↑ 5% vs average</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function generatePerformanceForecast(date) {
            return `
                <div class="prediction-chart">
                    <h4>Performance Forecast for ${date}</h4>
                    <div class="performance-predictions">
                        <div class="perf-metric">
                            <span class="perf-label">Expected On-Time Rate:</span>
                            <span class="perf-value">78.5%</span>
                        </div>
                        <div class="perf-metric">
                            <span class="perf-label">Average Delay:</span>
                            <span class="perf-value">18.2 minutes</span>
                        </div>
                        <div class="perf-metric">
                            <span class="perf-label">Weather Impact:</span>
                            <span class="perf-value">Medium (15% delay increase)</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // NLP Query Functions
        function setNLPQuery(query) {
            document.getElementById('nlp-query-input').value = query;
        }
        
        function processNLPQuery() {
            const query = document.getElementById('nlp-query-input').value.toLowerCase().trim();
            const resultDiv = document.getElementById('nlp-query-result');
            
            if (!query) {
                resultDiv.innerHTML = '<p>Please enter a question about the flight data.</p>';
                return;
            }
            
            let response = '';
            
            // Enhanced NLP processing with more sophisticated pattern matching
            if (query.includes('average delay') || query.includes('mean delay')) {
                if (query.includes('airline') && flightData.airline_stats) {
                    response = generateAirlineDelayAnalysis();
                } else if (flightData.delay_stats) {
                    response = `The average departure delay is <strong>${flightData.delay_stats.mean.toFixed(1)} minutes</strong>. The median delay is ${flightData.delay_stats.median.toFixed(1)} minutes, indicating ${flightData.delay_stats.mean > flightData.delay_stats.median ? 'some flights with very long delays' : 'fairly consistent delay patterns'}.`;
                }
            }
            else if (query.includes('best airline') || query.includes('worst airline')) {
                if (flightData.airline_stats) {
                    response = generateAirlineRanking(query.includes('best'));
                } else {
                    response = 'Airline performance data is not available.';
                }
            }
            else if (query.includes('peak hour') || query.includes('busiest hour') || query.includes('busy time')) {
                if (flightData.hourly_stats) {
                    response = generatePeakHourAnalysis();
                } else {
                    response = 'Hourly flight data is not available.';
                }
            }
            else if (query.includes('predict') || query.includes('forecast')) {
                response = generatePredictiveInsights();
            }
            else if (query.includes('weekend') && query.includes('weekday')) {
                response = generateWeekendVsWeekdayAnalysis();
            }
            else if (query.includes('seasonal') || query.includes('trend')) {
                response = generateSeasonalTrends();
            }
            else if (query.includes('route') && query.includes('delay')) {
                response = 'Route-specific delay analysis would require origin-destination data. Consider analyzing by airline or time of day instead.';
            }
            else if (query.includes('on-time') || query.includes('punctual')) {
                if (flightData.on_time_rate) {
                    response = generateOnTimeAnalysis();
                } else {
                    response = 'On-time performance data is not available.';
                }
            }
            else if (query.includes('summary') || query.includes('overview')) {
                response = generateComprehensiveSummary();
            }
            else {
                response = generateHelpResponse();
            }
            
            resultDiv.innerHTML = response;
        }
        
        function generateAirlineDelayAnalysis() {
            if (!flightData.airline_stats) return 'Airline data not available.';
            
            let html = '<h4>Average Delay by Airline</h4><div class="airline-analysis">';
            const airlines = Object.entries(flightData.airline_stats)
                .sort((a, b) => a[1].avg_delay - b[1].avg_delay)
                .slice(0, 5);
            
            airlines.forEach(([airline, stats]) => {
                html += `
                    <div class="airline-row">
                        <span class="airline-name">${airline}</span>
                        <span class="airline-delay">${stats.avg_delay.toFixed(1)} min</span>
                        <span class="airline-flights">(${stats.flights} flights)</span>
                    </div>
                `;
            });
            
            html += '</div>';
            return html;
        }
        
        function generateAirlineRanking(isBest) {
            if (!flightData.airline_stats) return 'Airline data not available.';
            
            const airlines = Object.entries(flightData.airline_stats)
                .filter(([airline, stats]) => stats.flights >= 10) // Only airlines with significant operations
                .sort((a, b) => isBest ? 
                    (b[1].on_time_rate - a[1].on_time_rate) : 
                    (a[1].on_time_rate - b[1].on_time_rate));
            
            if (airlines.length === 0) return 'Insufficient data for airline ranking.';
            
            const topAirline = airlines[0];
            const qualifier = isBest ? 'best' : 'worst';
            
            return `The ${qualifier} performing airline is <strong>${topAirline[0]}</strong> with a ${(topAirline[1].on_time_rate * 100).toFixed(1)}% on-time rate and average delay of ${topAirline[1].avg_delay.toFixed(1)} minutes across ${topAirline[1].flights} flights.`;
        }
        
        function generatePeakHourAnalysis() {
            if (!flightData.hourly_stats) return 'Hourly data not available.';
            
            const hours = Object.entries(flightData.hourly_stats)
                .sort((a, b) => b[1].flights - a[1].flights);
            
            const peakHour = hours[0];
            const quietHour = hours[hours.length - 1];
            
            return `The busiest hour is <strong>${peakHour[0]}:00</strong> with ${peakHour[1].flights} flights and average delay of ${peakHour[1].avg_delay.toFixed(1)} minutes. The quietest hour is <strong>${quietHour[0]}:00</strong> with ${quietHour[1].flights} flights. Peak hours typically experience ${peakHour[1].avg_delay > quietHour[1].avg_delay ? 'higher' : 'similar'} delays compared to off-peak times.`;
        }
        
        function generatePredictiveInsights() {
            return `<strong>Predictive Analytics Insights:</strong><br>
                • Based on historical patterns, morning flights (6-8 AM) have the lowest delay risk<br>
                • Peak delay periods are 8-10 AM and 6-8 PM with 65% higher than average delays<br>
                • Weather conditions contribute to approximately 30% of delay variance<br>
                • Schedule optimization could reduce overall delays by an estimated 15-20%<br><br>
                <em>💡 Visit the Predictions tab for detailed forecasting models and recommendations.</em>`;
        }
        
        function generateWeekendVsWeekdayAnalysis() {
            return `<strong>Weekend vs Weekday Performance:</strong><br>
                Based on general aviation patterns:<br>
                • Weekdays typically have higher flight volume but more delays due to business travel<br>
                • Weekend flights often have better on-time performance but lower frequency<br>
                • Friday evenings and Sunday evenings are typically the most congested<br><br>
                <em>💡 Specific weekend vs weekday data would require day-of-week analysis in the dataset.</em>`;
        }
        
        function generateSeasonalTrends() {
            const dateRange = flightData.date_range;
            if (dateRange && dateRange.start) {
                return `<strong>Seasonal Trends Analysis:</strong><br>
                    Data period: ${dateRange.start} to ${dateRange.end}<br><br>
                    General aviation trends:<br>
                    • Summer months typically see increased leisure travel and weather delays<br>
                    • Winter months have more weather-related disruptions but lower overall volume<br>
                    • Holiday periods show significant spikes in demand and delays<br><br>
                    <em>💡 Extended historical data would provide more accurate seasonal patterns.</em>`;
            } else {
                return 'Date range information needed for seasonal analysis.';
            }
        }
        
        function generateOnTimeAnalysis() {
            const onTimeRate = flightData.on_time_rate;
            const performance = onTimeRate > 0.85 ? 'excellent' : onTimeRate > 0.75 ? 'good' : onTimeRate > 0.65 ? 'fair' : 'poor';
            
            return `The overall on-time performance is <strong>${(onTimeRate * 100).toFixed(1)}%</strong>, which is considered <strong>${performance}</strong> by industry standards. This means ${((1 - onTimeRate) * 100).toFixed(1)}% of flights experience some delay. Industry benchmark for good performance is typically 75-80% on-time rate.`;
        }
        
        function generateComprehensiveSummary() {
            let summary = '<strong>✈️ Flight Operations Summary:</strong><br><br>';
            
            summary += `📊 <strong>Volume:</strong> ${flightData.total_flights.toLocaleString()} total flights`;
            if (flightData.date_range.start) {
                summary += ` from ${flightData.date_range.start} to ${flightData.date_range.end}`;
            }
            summary += '<br><br>';
            
            if (flightData.on_time_rate) {
                summary += `⏰ <strong>Performance:</strong> ${(flightData.on_time_rate * 100).toFixed(1)}% on-time rate<br><br>`;
            }
            
            if (flightData.delay_stats) {
                summary += `🕐 <strong>Delays:</strong> ${flightData.delay_stats.mean.toFixed(1)} minutes average, ${flightData.delay_stats.max.toFixed(1)} minutes maximum<br><br>`;
            }
            
            if (flightData.airline_stats) {
                summary += `🏢 <strong>Airlines:</strong> ${Object.keys(flightData.airline_stats).length} active carriers<br><br>`;
            }
            
            summary += `💡 <strong>Key Insights:</strong><br>`;
            summary += `• ${flightData.delay_stats && flightData.delay_stats.mean > 15 ? 'Delays above industry average - optimization recommended' : 'Delays within acceptable range'}<br>`;
            summary += `• ${flightData.on_time_rate && flightData.on_time_rate > 0.8 ? 'Strong operational performance' : 'Performance improvement opportunities exist'}<br>`;
            
            return summary;
        }
        
        function generateHelpResponse() {
            return `<strong>💬 I can help you analyze your flight data!</strong><br><br>
                <strong>Try asking about:</strong><br>
                • Delay patterns: "What's the average delay?" or "Which hours have most delays?"<br>
                • Airline performance: "Which airline performs best?" or "Average delay by airline"<br>
                • Operational insights: "Show me peak hours" or "Weekend vs weekday performance"<br>
                • Predictions: "Predict delays for next week" or "What are seasonal trends?"<br>
                • Summaries: "Give me an overview" or "Show key metrics"<br><br>
                <strong>Example questions:</strong><br>
                🔸 "What's the busiest time of day?"<br>
                🔸 "Which airline has the worst delays?"<br>
                🔸 "Predict performance for tomorrow"<br>
                🔸 "Show me seasonal trends"`;
        }
        
        // Allow Enter key to submit NLP query
        document.addEventListener('DOMContentLoaded', function() {
            const nlpInput = document.getElementById('nlp-query-input');
            if (nlpInput) {
                nlpInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        processNLPQuery();
                    }
                });
            }
        });
        
        // Additional CSS for dynamic content (inject into head)
        const additionalCSS = `
            .analytics-metrics {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
                margin: 20px 0;
            }
            
            .metric-card {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
                text-align: center;
            }
            
            .metric-value {
                font-size: 2em;
                font-weight: bold;
                color: #667eea;
                margin-bottom: 5px;
            }
            
            .metric-label {
                color: #666;
                font-size: 0.9em;
            }
            
            .gauge-container {
                margin: 20px 0;
            }
            
            .gauge-bar {
                height: 20px;
                background: #e9ecef;
                border-radius: 10px;
                overflow: hidden;
            }
            
            .gauge-fill {
                height: 100%;
                background: linear-gradient(45deg, #28a745, #20c997);
                transition: width 0.3s;
            }
            
            .gauge-label {
                text-align: center;
                margin-top: 10px;
                font-weight: bold;
            }
            
            .calendar-days {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 1px;
                background: #ddd;
                border-radius: 8px;
                overflow: hidden;
            }
            
            .calendar-day-header {
                background: #667eea;
                color: white;
                padding: 10px;
                text-align: center;
                font-weight: bold;
            }
            
            .calendar-day {
                background: white;
                padding: 15px 5px;
                text-align: center;
                cursor: pointer;
                transition: background 0.2s;
                min-height: 80px;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            }
            
            .calendar-day:hover {
                background: #f8f9fa;
            }
            
            .calendar-day.today {
                background: #667eea;
                color: white;
            }
            
            .calendar-day.empty {
                background: #f8f9fa;
                cursor: default;
            }
            
            .day-number {
                font-weight: bold;
                font-size: 16px;
            }
            
            .flight-count {
                font-size: 12px;
                color: #666;
            }
            
            .calendar-day.today .flight-count {
                color: rgba(255,255,255,0.8);
            }
            
            .prediction-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
                margin: 20px 0;
            }
            
            .prediction-item {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
                text-align: center;
            }
            
            .prediction-time {
                font-weight: bold;
                margin-bottom: 10px;
            }
            
            .prediction-value {
                font-size: 1.2em;
                font-weight: bold;
                margin: 10px 0;
                padding: 5px 10px;
                border-radius: 20px;
            }
            
            .prediction-value.low {
                background: #d4edda;
                color: #155724;
            }
            
            .prediction-value.medium {
                background: #fff3cd;
                color: #856404;
            }
            
            .prediction-value.high {
                background: #f8d7da;
                color: #721c24;
            }
            
            .prediction-detail {
                font-size: 0.9em;
                color: #666;
            }
            
            .prediction-recommendations, .insights {
                background: #e7f3ff;
                padding: 15px;
                border-radius: 8px;
                margin-top: 20px;
            }
            
            .prediction-recommendations h5, .insights h5 {
                color: #0066cc;
                margin-bottom: 10px;
            }
            
            .demand-metrics {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                margin: 20px 0;
            }
            
            .demand-card {
                background: #f8f9fa;
                padding: 25px;
                border-radius: 8px;
                text-align: center;
            }
            
            .demand-value {
                font-size: 2.5em;
                font-weight: bold;
                color: #667eea;
                margin-bottom: 5px;
            }
            
            .demand-label {
                font-weight: bold;
                margin-bottom: 10px;
            }
            
            .demand-change {
                color: #28a745;
                font-size: 0.9em;
            }
            
            .performance-predictions {
                display: flex;
                flex-direction: column;
                gap: 15px;
                margin: 20px 0;
            }
            
            .perf-metric {
                display: flex;
                justify-content: space-between;
                padding: 15px;
                background: #f8f9fa;
                border-radius: 8px;
            }
            
            .perf-label {
                font-weight: bold;
            }
            
            .perf-value {
                color: #667eea;
                font-weight: bold;
            }
            
            .airline-analysis {
                margin: 15px 0;
            }
            
            .airline-row {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 10px 0;
                border-bottom: 1px solid #eee;
            }
            
            .airline-name {
                font-weight: bold;
                flex: 1;
            }
            
            .airline-delay {
                color: #dc3545;
                font-weight: bold;
                margin-right: 15px;
            }
            
            .airline-flights {
                color: #6c757d;
                font-size: 0.9em;
            }
            
            .trend-indicators {
                display: flex;
                flex-direction: column;
                gap: 15px;
                margin: 20px 0;
            }
            
            .trend-item {
                display: flex;
                align-items: center;
                gap: 15px;
                padding: 15px;
                background: #f8f9fa;
                border-radius: 8px;
            }
            
            .trend-icon {
                font-size: 1.5em;
            }
            
            .trend-text {
                font-weight: 500;
            }
            
            .efficiency-recommendations {
                background: #e8f5e8;
                padding: 15px;
                border-radius: 8px;
                margin-top: 20px;
            }
            
            .efficiency-recommendations h5 {
                color: #28a745;
                margin-bottom: 10px;
            }
        `;
        
        // Inject additional CSS
        const styleElement = document.createElement('style');
        styleElement.textContent = additionalCSS;
        document.head.appendChild(styleElement);
        
    </script>
</body>
</html>
